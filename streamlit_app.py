import streamlit as st
from pymorphy2 import MorphAnalyzer

# Инициализация морфологического анализатора
morph = MorphAnalyzer(lang='ru')

# Функция лемматизации
def lemmatize(text):
    return [morph.parse(word)[0].normal_form for word in text.lower().split()]

# Данные адаптации
adaptation_plan = {
    1: "День 1: Знакомство с банком и командой.",
    2: "День 2: Оформление доступов.",
    3: "День 3: Знакомство с продуктами банка."
}

# Часто задаваемые вопросы
faq = {
    "доступ": "Оформление доступов осуществляется через службу поддержки (HelpDesk).",
    "продукт": "Информацию о продуктах банка можно найти в базе знаний на внутреннем портале.",
    "обратная связь": "Обратную связь можно оставить через корпоративную систему."
}

# Напоминания
reminders = {
    2: "Завтра в 10:00 запланирован тренинг по продуктам.",
    3: "Сегодня в 13:00 состоится обед с командой."
}

# Настройки страницы
st.set_page_config(page_title="Ева — ассистент адаптации", layout="centered")
st.title("Ева — цифровой ассистент по адаптации")

# Боковая панель: выбор дня адаптации
day = st.sidebar.number_input("Укажите текущий день адаптации (от 1 до 3):", min_value=1, max_value=3, value=1)
st.sidebar.write("План на сегодня:", adaptation_plan.get(day, "Информация недоступна."))
st.sidebar.write("Напоминание:", reminders.get(day, "На сегодня напоминаний нет."))

# Раздел: быстрые ответы
st.subheader("Ответы на часто задаваемые вопросы")
user_question = st.text_input("Введите ваш вопрос (например: как оформить доступы):")

if user_question:
    lemmas = lemmatize(user_question)
    response = "Ответ не найден. Пожалуйста, уточните вопрос или обратитесь к наставнику."
    for lemma in lemmas:
        for keyword in faq:
            if keyword in lemma:
                response = faq[keyword]
                break
    st.write("Ответ:", response)

# Раздел: самооценка состояния
st.subheader("Оценка текущего состояния")
mood = st.slider("Оцените своё состояние от 1 (неудовлетворительно) до 5 (отлично):", 1, 5)

if mood <= 2:
    st.error("Вы указали низкий уровень комфорта. Рекомендуется обсудить это с менеджером или наставником.")
elif mood <= 3:
    st.warning("Обратите внимание на своё состояние. При необходимости — обратитесь за поддержкой.")
else:
    st.success("Хорошее самочувствие зафиксировано. Продолжайте в том же духе.")

# Конец
st.caption("Ассистент Ева — часть программы сопровождения новых сотрудников ПСБ.")
